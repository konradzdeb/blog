---
title: Using Python ML Models in DIY Mobile Applications
author: Konrad Zdeb
date: '2025-05-02'
slug: python-modesl-app
categories:
  - how-to
tags:
  - swift
  - ML
  - Python
---

Arrival of CoreML Framework in June 2017 open up an exciting possibility of productionings models on Apple devices. This is particulary attractive in the context of deploying ML-reliant applications on mobile devices, offering access to a significant market. In order to introduce a ML solution into a Swift-based sofwtare product `.mlmodel` file would need to be produced. The two common mechanisms facilitating that process are:
1. Leveragining Apple's Create ML App or Create ML framework (for programmatic model creation)
2. Leveraging `coremltools` Python package and preparing model elsewhere to be imported into the production


# Python's Model

For the purpose of demonstration we will create basic modelling solution in Python 

```{r include_github_code, echo=FALSE, results='asis'}
# Raw GitHub file URL (make sure it's the *raw* version)
url <- "https://raw.githubusercontent.com/konradzdeb/SwiftPythonML/refs/heads/master/PythonMLModel/model_train.py"
code_lines <- readLines(url)
writeLines(code_lines, "temp_fetched_code.py")
code_block <- paste0("```r\n", paste(code_lines, collapse = "\n"), "\n```")
# cat(code_block)
knitr::asis_output(code_block)
```

```{r set_python_env, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE, include=FALSE}
reticulate::virtualenv_create(
    envname = "swiftml",
    packages = c("scikit-learn", "numpy<2", "torchvision"),
    force = FALSE
)
reticulate::use_virtualenv("swiftml", required = TRUE)
```
Following execution of that code we get an unsophisticated model.

```{python run_python_code, echo=FALSE, results='asis'}
with open('temp_fetched_code.py', 'r') as file:
    content = file.read()
    exec(content)
```

The key challenge would be brining the model into the 
